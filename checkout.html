<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procesar Pedido - Cloud¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
</head>
<body class="flex flex-col min-h-screen antialiased">
<div id="particles-js"></div>
    <header id="encabezado" class="barra-navegacion-fija transition-all duration-300">
        
        <nav class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="index.html" class="text-2xl font-bold text-sky-400 logo-con-tema">Cloud¡</a>
                
                <div class="flex items-center space-x-4">
                    <a href="index.html#precios" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold px-4 py-2 rounded-lg transition-colors text-sm">Ver Planes</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="flex-grow py-2 md:py-6">
        <div class="container mx-auto px-6">
            <div class="bg-slate-800 p-8 md:p-12 rounded-xl shadow-xl fondo-papel-con-tema">
                
                <h1 id="titulo-checkout" class="text-3xl md:text-4xl font-bold text-white mb-8 text-center texto-primario-con-tema">Procesar Pedido</h1>
                

                <div id="detalles-plan" class="mb-8 p-6 bg-slate-700 rounded-lg fondo-acento-con-tema">
                    
                    <h2 class="text-2xl font-semibold text-sky-400 mb-3 texto-enlace-con-tema">Plan Seleccionado: <span id="nombre-plan-seleccionado">Cargando...</span></h2>
                    
                    <p class="text-slate-300 texto-secundario-con-tema">Precio: <span id="precio-plan-seleccionado">--</span></p>
                    
                    <p class="text-slate-300 texto-secundario-con-tema">Características clave: <span id="caracteristicas-plan-seleccionado">--</span></p>
                    
                </div>

                <form id="formulario-checkout" class="space-y-6">
                    
                    <div>
                        <label for="nombreCompleto" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">Nombre Completo</label>
                        <input type="text" id="nombreCompleto" class="bg-slate-700 border border-slate-600 text-slate-200 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-full p-2.5 entrada-con-tema" placeholder="Juan Pérez" required>
                        
                    </div>
                    <div>
                        <label for="correoElectronico" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">Correo Electrónico</label>
                        <input type="email" id="correoElectronico" class="bg-slate-700 border border-slate-600 text-slate-200 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-full p-2.5 entrada-con-tema" placeholder="juan.perez@ejemplo.com" required>
                        
                    </div>

                    <div id="seccion-pago">
                        
                        <h3 class="text-xl font-semibold text-white mb-4 mt-8 texto-primario-con-tema">Detalles de Pago (Simulación)</h3>
                        <div>
                            <label for="numeroTarjeta" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">Número de Tarjeta</label>
                            <input type="text" id="numeroTarjeta" class="bg-slate-700 border border-slate-600 text-slate-200 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-full p-2.5 entrada-con-tema" placeholder="•••• •••• •••• ••••" required>
                            
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-4">
                            <div>
                                <label for="fechaVencimiento" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">Fecha de Vencimiento</label>
                                <input type="text" id="fechaVencimiento" class="bg-slate-700 border border-slate-600 text-slate-200 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-full p-2.5 entrada-con-tema" placeholder="MM/AA" required>
                                
                            </div>
                            <div>
                                <label for="codigoCVC" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">CVC</label>
                                <input type="text" id="codigoCVC" class="bg-slate-700 border border-slate-600 text-slate-200 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-full p-2.5 entrada-con-tema" placeholder="•••" required>
                                
                            </div>
                        </div>
                    </div>

    <div id="seccion-contacto" class="hidden">
    
    <label for="mensaje" class="block mb-2 text-sm font-medium text-slate-300 texto-secundario-con-tema">Tu Mensaje</label>
    <textarea id="mensaje" rows="4" maxlength="1000" class="block p-2.5 w-full text-sm text-slate-200 bg-slate-700 rounded-lg border border-slate-600 focus:ring-sky-500 focus:border-sky-500 entrada-con-tema" placeholder="Escribe tu consulta aquí..."></textarea>
    
    <div id="contador-caracteres-mensaje" class="text-xs text-slate-400 mt-1">0/1000 caracteres</div>
    </div>

                    <button type="submit" id="boton-enviar-formulario" class="w-full text-white bg-sky-500 hover:bg-sky-600 focus:ring-4 focus:outline-none focus:ring-sky-300 font-medium rounded-lg text-sm px-5 py-3 text-center transition-colors">
                        Pagar Ahora (Simulación)
                    </button>
                    
                </form>
            </div>
        </div>
    </main>

    <footer class="bg-slate-900 border-t border-slate-700 py-8 fondo-pie-pagina-con-tema">
        
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center text-sm text-slate-400 texto-pie-pagina-con-tema">
                
                <p class="mb-4 md:mb-0">© <span id="anioActual"></span> Cloud¡. Todos los derechos reservados.</p>
                
                <div class="flex space-x-4 md:space-x-6">
                    <a href="aviso-legal.html" class="hover:text-sky-400 transition-colors enlace-texto-pie-pagina-con-tema">Aviso Legal</a>
                    <a href="terminos-condiciones.html" class="hover:text-sky-400 transition-colors enlace-texto-pie-pagina-con-tema">Términos y Condiciones</a>
                    <a href="politica-privacidad.html" class="hover:text-sky-400 transition-colors enlace-texto-pie-pagina-con-tema">Política de Privacidad</a>
                    
                </div>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="particle.js" defer></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const plan = params.get('plan');
        const accion = params.get('action');

        const elDetallesPlan = document.getElementById('detalles-plan');
        const elNombrePlanSeleccionado = document.getElementById('nombre-plan-seleccionado');
        const elPrecioPlanSeleccionado = document.getElementById('precio-plan-seleccionado');
        const elCaracteristicasPlanSeleccionado = document.getElementById('caracteristicas-plan-seleccionado');
        const elTituloCheckout = document.getElementById('titulo-checkout');
        const elSeccionPago = document.getElementById('seccion-pago');
        const elSeccionContacto = document.getElementById('seccion-contacto');
        const elBotonEnviarFormulario = document.getElementById('boton-enviar-formulario');
        const elFormulario = document.getElementById('formulario-checkout');
        const campoMensaje = document.getElementById('mensaje');
        
        const contadorCaracteresMensajeEl = document.getElementById('contador-caracteres-mensaje');
        const MAX_CARACTERES_MENSAJE = 1000; 

        function actualizarVisibilidadContador() {
            if (contadorCaracteresMensajeEl && elSeccionContacto) {
                if (!elSeccionContacto.classList.contains('hidden') && campoMensaje && campoMensaje.required) {
                    contadorCaracteresMensajeEl.classList.remove('hidden');
                } else {
                    contadorCaracteresMensajeEl.classList.add('hidden');
                }
            }
        }

        function resetearContadorMensaje() {
            if (contadorCaracteresMensajeEl) {
                contadorCaracteresMensajeEl.textContent = `0/${MAX_CARACTERES_MENSAJE} caracteres`;
                contadorCaracteresMensajeEl.classList.remove('text-red-500', 'text-yellow-500');
            }
            actualizarVisibilidadContador();
        }

        if (campoMensaje && contadorCaracteresMensajeEl) {
            campoMensaje.addEventListener('input', () => {
                const longitudActual = campoMensaje.value.length;
                contadorCaracteresMensajeEl.textContent = `${longitudActual}/${MAX_CARACTERES_MENSAJE} caracteres`;

                contadorCaracteresMensajeEl.classList.remove('text-red-500', 'text-yellow-500'); 
                if (longitudActual > MAX_CARACTERES_MENSAJE) { 
                    contadorCaracteresMensajeEl.classList.add('text-red-500');
                } else if (longitudActual > MAX_CARACTERES_MENSAJE * 0.9) {
                    contadorCaracteresMensajeEl.classList.add('text-yellow-500');
                }
            });
        }

        if (accion === 'contact' || plan === 'empresarial') {
            if(elTituloCheckout) elTituloCheckout.textContent = 'Contactar con Ventas';
            if(elDetallesPlan) elDetallesPlan.classList.add('hidden');
            if(elSeccionPago) elSeccionPago.classList.add('hidden');
            if(elSeccionContacto) elSeccionContacto.classList.remove('hidden');
            if(elBotonEnviarFormulario) elBotonEnviarFormulario.textContent = 'Enviar Consulta';

            if(elSeccionPago) {
                elSeccionPago.querySelectorAll('input').forEach(input => input.required = false);
            }
            if (campoMensaje) {
                 campoMensaje.required = true;
            }
            resetearContadorMensaje(); 

        } else if (plan) {
            if(elTituloCheckout) elTituloCheckout.textContent = 'Procesar Pedido';
            if(elDetallesPlan) elDetallesPlan.classList.remove('hidden');
            if(elSeccionPago) elSeccionPago.classList.remove('hidden');
            if(elSeccionContacto) elSeccionContacto.classList.add('hidden');
            if(elBotonEnviarFormulario) elBotonEnviarFormulario.textContent = 'Pagar Ahora (Simulación)';

            if(elSeccionPago) {
                elSeccionPago.querySelectorAll('input').forEach(input => input.required = true);
            }
            if (campoMensaje) {
                campoMensaje.required = false;
            }
            actualizarVisibilidadContador(); 

            let nombrePlan = '';
            let precioPlan = '';
            let caracteristicasPlan = '';

            switch(plan) {
                case 'basico':
                    nombrePlan = 'Básico';
                    precioPlan = '$9.000/mes';
                    caracteristicasPlan = '1 Sitio Web, Mantenimiento por 2 meses, Subdominio unico, SSL Gratuito.';
                    break;
                case 'pro':
                    nombrePlan = 'Estandar';
                    precioPlan = '$15.000/mes';
                    caracteristicasPlan = '2 Sitios Web, Mantenimiento por 6 meses, Subdominio personalizable, SSL y CDN, Soporte Prioritario.';
                    break;
                default:
                    if(elDetallesPlan) elDetallesPlan.classList.add('hidden');
                    if(elTituloCheckout) elTituloCheckout.textContent = 'Plan no especificado';
                    if(elFormulario) elFormulario.classList.add('hidden');
            }
            if(elNombrePlanSeleccionado) elNombrePlanSeleccionado.textContent = nombrePlan;
            if(elPrecioPlanSeleccionado) elPrecioPlanSeleccionado.textContent = precioPlan;
            if(elCaracteristicasPlanSeleccionado) elCaracteristicasPlanSeleccionado.textContent = caracteristicasPlan;

        } else if (accion !== 'contact'){
            if(elTituloCheckout) elTituloCheckout.textContent = 'Información no disponible';
            if(elDetallesPlan) elDetallesPlan.classList.add('hidden');
            if(elSeccionPago) elSeccionPago.classList.add('hidden');
            if(elSeccionContacto) elSeccionContacto.classList.add('hidden'); 
            if(elFormulario) elFormulario.classList.add('hidden');
            actualizarVisibilidadContador(); 
        }


        if(elFormulario && !elFormulario.classList.contains('hidden')) {
            elFormulario.addEventListener('submit', (e) => {
                e.preventDefault();

                let formValido = true;
                elFormulario.querySelectorAll('input[required], textarea[required]').forEach(input => {
                    const fieldContainer = input.closest('#seccion-pago, #seccion-contacto, div:not(#seccion-pago):not(#seccion-contacto)'); 
                    let isVisibleAndRequired = input.required;

                    if (fieldContainer) { 
                        if(fieldContainer.id === 'seccion-pago' && elSeccionPago.classList.contains('hidden')) {
                            isVisibleAndRequired = false;
                        } else if (fieldContainer.id === 'seccion-contacto' && elSeccionContacto.classList.contains('hidden')) {
                            isVisibleAndRequired = false;
                        }
                    }
                    
                    
                    if (isVisibleAndRequired && !input.value.trim()) {
                        formValido = false;
                        input.classList.add('border-red-500'); 
                    } else {
                        input.classList.remove('border-red-500');
                    }
                });

                if (!formValido) {
                    alert('Por favor, completa todos los campos requeridos correctamente.');
                    return;
                }

                
                const esContacto = accion === 'contact' || plan === 'empresarial';
                if (esContacto) {
                    alert('¡Gracias por tu consulta! Nos pondremos en contacto contigo pronto.');
                } else {
                    alert('¡Gracias por tu compra! (Esto es una simulación, no se ha procesado ningún pago real).');
                }
                
                elFormulario.reset();
                elFormulario.querySelectorAll('.border-red-500').forEach(el => el.classList.remove('border-red-500')); 

                
                
                if (esContacto) {
                    resetearContadorMensaje();
                } else {
                    if (contadorCaracteresMensajeEl) contadorCaracteresMensajeEl.classList.add('hidden');
                }
            });
        }
        actualizarVisibilidadContador();
    });
</script>
</body>
</html>